<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸµ Web DJ Pad ğŸµ</title>
  <style>
    body {background: #1a1a2e; color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0;}
    h1 {text-align: center; color: #00d4ff; margin-top: 32px;}
    .panel {display: flex; justify-content: center; gap: 36px; margin: 24px 0;}
    .panel label {display:inline-flex;align-items:center;gap:8px;}
    .grid {display: grid; grid-template-columns: repeat(4,1fr); gap: 20px; max-width: 500px; margin: 0 auto;}
    .pad {background:linear-gradient(145deg,#2a2a3a,#1a1a2a); border-radius:18px; min-height:90px; display:flex;flex-direction:column;align-items:center; justify-content:center; cursor:pointer; font-size:1.4rem; user-select:none; box-shadow:0 8px 25px rgba(0,0,0,0.3); transition:.2s;}
    .pad:active {background:linear-gradient(145deg,#00d4ff,#ff4081);}
    .pad-label {font-size:1rem; margin-top:4px;}
    .mode-btn {padding:8px 18px; border:none; border-radius:12px; margin:0 2px; cursor:pointer; background:#222; color:#eee;}
    .mode-btn.active {background:linear-gradient(45deg,#00d4ff,#ff4081); color:#fff;}
    .volume-slider {width:120px;}
  </style>
</head>
<body>
  <h1>ğŸµ Web DJ Pad ğŸµ</h1>
  <div class="panel">
    <label>ğŸ”Š éŸ³é‡ <input type="range" id="volume" class="volume-slider" min="0" max="100" value="80"></label>
    <label>æ¨¡å¼
      <button class="mode-btn active" data-mode="normal">æ¨™æº–</button>
      <button class="mode-btn" data-mode="loop">å¾ªç’°</button>
      <button class="mode-btn" data-mode="oneshot">å–®æ¬¡</button>
    </label>
  </div>
  <div class="grid" id="padGrid"></div>
  <script>
    // PAD key è¨­å®šèˆ‡æª”æ¡ˆè·¯å¾‘
    const padKeys = ["1","2","3","4","Q","W","E","R","A","S","D","F","Z","X","C","V"];
    const padLabels = padKeys.map((k,i) => `Pad ${i+1} (${k})`);
    // éŸ³æ•ˆè·¯å¾‘ç¯„ä¾‹ï¼šaudio/1.mp3, audio/Q.mp3 ...
    const padSounds = padKeys.map(k => `audio/${k}.mp3`);

    // æ’­æ”¾åƒæ•¸
    let playMode = "normal"; // normal, loop, oneshot
    let volume = 0.8;
    let activeAudios = {};

    // ä¸»éŸ³é‡æ§åˆ¶
    const volumeSlider = document.getElementById('volume');
    volumeSlider.oninput = e => volume = e.target.value / 100;

    // æ¨¡å¼åˆ‡æ›
    document.querySelectorAll('.mode-btn').forEach(btn => {
      btn.onclick = () => {
        document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        playMode = btn.dataset.mode;
      }
    });

    // çµ„ä»¶ç”Ÿæˆ
    const padGrid = document.getElementById('padGrid');
    padKeys.forEach((key, idx) => {
      const pad = document.createElement('div');
      pad.className = "pad";
      pad.tabIndex = 0;
      pad.innerHTML = `<strong>${key}</strong><div class="pad-label">${padLabels[idx]}</div>`;
      pad.onclick = () => playPad(key, idx);
      padGrid.appendChild(pad);
    });

    // æ’­æ”¾ä¸»å‡½å¼
    function playPad(key, idx){
      // å–®æ¬¡æ¨¡å¼ï¼Œå…¨éƒ¨åœæ­¢
      if(playMode==="oneshot") stopAllPads();

      // è¿´åœˆæ¨¡å¼: è‹¥æœ‰åœ¨æ’­å‰‡åœæ‰
      if(playMode==="loop" && activeAudios[key]){
        stopPad(key);
        return;
      }

      stopPad(key);
      const pad = padGrid.children[idx];
      pad.classList.add('active');
      const audio = new Audio(padSounds[idx]);
      audio.volume = volume;
      audio.onended = () => { pad.classList.remove('active'); delete activeAudios[key];};
      if(playMode==="loop") audio.loop = true;
      activeAudios[key]=audio;
      audio.play();
    }

    // åœæ­¢æŸ pad
    function stopPad(key){
      if(activeAudios[key]){
        activeAudios[key].pause();
        activeAudios[key].currentTime = 0;
        delete activeAudios[key];
      }
      Array.from(padGrid.children).forEach(pad=>{
        if(pad.querySelector("strong").textContent===key) pad.classList.remove('active');
      });
    }

    function stopAllPads(){
      Object.keys(activeAudios).forEach(stopPad);
    }

    // éµç›¤å¿«æ·éµæ”¯æ´
    document.addEventListener('keydown', e=>{
      const key = e.key.toUpperCase();
      const idx = padKeys.indexOf(key);
      if(idx>=0) playPad(key, idx);
      // Space åœæ­¢å…¨éƒ¨
      if(e.code==="Space") stopAllPads();
      // Ctrl+æŒ‰ pad åœæ­¢æ­¤ pad
      if(idx>=0 && (e.ctrlKey||e.metaKey)) stopPad(key);
    });
  </script>
</body>
</html>